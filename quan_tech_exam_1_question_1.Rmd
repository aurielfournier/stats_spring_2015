---
output: pdf_document
---
# Point Pattern Exam Question 1
## Auriel MV Fournier

```{r, fig.width=8}
library(spatstat)

data(bei)

plot(bei)

elev <- bei.extra$elev
grad <- bei.extra$grad
plot(elev)
plot(grad)
q <- quadratcount(bei, nx=6,ny=3)
plot(bei)
plot(q, add=T)

den <- density.ppp(bei, sigma=70, kernel="gaussian")
plot(den)
plot(bei,add=T)

contour(den)

b <- quantile(grad, probs=(0:4)/4)
b2 <- quantile(grad, probs=c(0,0.25,1))
b3 <- quantile(grad, probs=c(0,.25,.75,1))
gradcut <- cut(grad, breaks=b, labels=c('low','mlow','mhigh','high'))
gradcut2 <- cut(grad, breaks=b2, labels=c('low','high'))
gradcut3 <- cut(grad, breaks=b3)
v <- tess(image=gradcut)
v2 <- tess(image=gradcut2)
v3 <- tess(image=gradcut3)
plot(v)
plot(bei, add=T)
qb <- quadratcount(bei, tess=v)
qb2 <- quadratcount(bei,tess=v2)
qb3 <- quadratcount(bei,tess=v3)
plot(rhohat(bei,grad))
plot(rhohat(bei,elev))
plot(cdf.test(bei,grad,test="ks"))
plot(cdf.test(bei,elev,test="ks"))

null <- ppm(bei)
grd <- ppm(bei ~ grad)
mv3 <- ppm(bei ~ v3)
mv2 <- ppm(bei ~ v2)
elv <- ppm(bei ~ elev)  
grd.elv <- ppm(bei ~ elev * grad)
grd_elv <- ppm(bei ~ elev + grad)

aic <- matrix(ncol=2, nrow=7)
aic[,1] <- c("null","grd","mv3","mv2","elv","grd.elv","grd_elv")
aic[,2] <- c(AIC(null),AIC(grd),AIC(mv3),AIC(mv2),AIC(elv),AIC(grd.elv),AIC(grd_elv))

aic

aic[aic[,2]==min(aic[,2]),]

diagnose.ppm(mv3)

```